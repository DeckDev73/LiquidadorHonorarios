<h2>Selecciona el especialista a liquidar</h2>

<label for="especialista">Especialista:</label>
<select name="profesional" id="especialista" required>
  {% for prof in profesionales %}
    <option value="{{ prof }}">{{ prof }}</option>
  {% endfor %}
</select>

<label for="especialidad">Especialidad:</label>
<select name="especialidad" id="especialidad" required>
  {% for prof, esp_list in profesionales.items() %}
    {% for esp in esp_list %}
      <option value="{{ esp }}">{{ esp }}</option>
    {% endfor %}
  {% endfor %}
</select>

<div id="tabla-especialista"></div>

<script>
  document.addEventListener('DOMContentLoaded', function () {
    const especialistaSelect = document.getElementById('especialista');
    const especialidadSelect = document.getElementById('especialidad');

    function cargarTabla() {
      const profesional = especialistaSelect.value;
      const especialidad = especialidadSelect.value;

      const url = `/tabla_especialista?profesional=${encodeURIComponent(profesional)}&especialidad=${encodeURIComponent(especialidad)}`;

      fetch(url)
        .then(response => response.text())
        .then(html => {
          document.getElementById('tabla-especialista').innerHTML = html;
        })
        .catch(error => {
          console.error('Error al cargar la tabla:', error);
        });
    }

    especialistaSelect.addEventListener('change', cargarTabla);
    especialidadSelect.addEventListener('change', cargarTabla);
    cargarTabla();  // Cargar al inicio
  });
</script>
